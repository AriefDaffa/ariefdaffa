---
import { getCollection } from 'astro:content'

import NavbarLayout from '@/layouts/NavbarLayout.astro'
import BlogCard from '@/components/Card/BlogCard.astro'

const blogs = await getCollection('blog')

blogs.sort(
  (a, b) =>
    Date.parse(b.data.date.toString()) - Date.parse(a.data.date.toString()),
)

const formatDate = (text: Date) => {
  return new Intl.DateTimeFormat('en-US', { dateStyle: 'long' }).format(
    new Date(text),
  )
}
---

<NavbarLayout title="Blogs">
  <div class="text-6xl font-bold py-8">Blog</div>
  <div class="w-full flex gap-4 pb-2 pt-8">
    <div class="w-full space-y-6">
      {
        blogs.map((blog, idx) => (
          <>
            <BlogCard
              url={`blog/${blog.slug}`}
              title={blog.data.title}
              date={formatDate(blog.data.date)}
              desc={blog.data.desc}
              image={blog.data.image}
            />
            {idx !== blogs.length - 1 && (
              <div class="h-[1px] w-full bg-gray-200 dark:bg-gray-600" />
            )}
          </>
        ))
      }
    </div>
  </div>
</NavbarLayout>
